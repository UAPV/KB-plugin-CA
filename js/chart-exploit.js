$(document).ready(function() {


    /********************* Higthchart ********************/
    Highcharts.setOptions({
        global: {
            useUTC: false
        }
    });

    Highcharts.chart('renouvellementDiagramme', {
        chart: {
            type: 'column'
        },
        title: {
            text: 'Prochain renouvellement'
        },
        xAxis: {
            "type": "datetime",
            "labels": {
                formatter: function() {
                    return Highcharts.dateFormat('%Y-%m-%d', this.value);
                }
            }
        },
        yAxis: {
            title: {
                text: 'Exploitation'
            },
            visible: false

        },
        legend: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y}'
                }
            },
            column:{
                events: {
                    click: function (event) {
                        if($(event.target).css('opacity') == 1){
                            $(event.target).parent().children().each(function(index, value){
                                $(value).css('opacity', '1');
                            })
                            var date = new Date(event.point.x);
                            $(event.target).css('opacity', '0.2');
                            $('#filtreRen ').val(date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate());
                        }else{
                            $(event.target).css('opacity', '1');
                            $('#filtreRen ').val('');
                        }

                        $('#filtreRen').trigger('change');
                    }
                }
            }
        },

        tooltip: {
            headerFormat: '',
            pointFormat: '<b style="color:{point.color}">{point.x:%Y-%m-%d}</b>:<br/>{point.name}'
        },

        series: [{
            name: '',
            colorByPoint: true,
            data: JSON.parse($('#columnRenvoullement').attr('value'))
        }]
    });

});